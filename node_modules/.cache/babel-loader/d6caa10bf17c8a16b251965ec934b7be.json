{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/spencer/Personal/Bibtex-web-database-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _asyncToGenerator from\"/home/spencer/Personal/Bibtex-web-database-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/spencer/Personal/Bibtex-web-database-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/home/spencer/Personal/Bibtex-web-database-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";function _regeneratorRuntime(){\"use strict\";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function _regeneratorRuntime(){return exports;};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value;},$Symbol=\"function\"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||\"@@iterator\",asyncIteratorSymbol=$Symbol.asyncIterator||\"@@asyncIterator\",toStringTagSymbol=$Symbol.toStringTag||\"@@toStringTag\";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key];}try{define({},\"\");}catch(err){define=function define(obj,key,value){return obj[key]=value;};}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,\"_invoke\",{value:makeInvokeMethod(innerFn,self,context)}),generator;}function tryCatch(fn,obj,arg){try{return{type:\"normal\",arg:fn.call(obj,arg)};}catch(err){return{type:\"throw\",arg:err};}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,function(){return this;});var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){[\"next\",\"throw\",\"return\"].forEach(function(method){define(prototype,method,function(arg){return this._invoke(method,arg);});});}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if(\"throw\"!==record.type){var result=record.arg,value=result.value;return value&&\"object\"==typeof value&&hasOwn.call(value,\"__await\")?PromiseImpl.resolve(value.__await).then(function(value){invoke(\"next\",value,resolve,reject);},function(err){invoke(\"throw\",err,resolve,reject);}):PromiseImpl.resolve(value).then(function(unwrapped){result.value=unwrapped,resolve(result);},function(error){return invoke(\"throw\",error,resolve,reject);});}reject(record.arg);}var previousPromise;defineProperty(this,\"_invoke\",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject);});}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg();}});}function makeInvokeMethod(innerFn,self,context){var state=\"suspendedStart\";return function(method,arg){if(\"executing\"===state)throw new Error(\"Generator is already running\");if(\"completed\"===state){if(\"throw\"===method)throw arg;return doneResult();}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult;}}if(\"next\"===context.method)context.sent=context._sent=context.arg;else if(\"throw\"===context.method){if(\"suspendedStart\"===state)throw state=\"completed\",context.arg;context.dispatchException(context.arg);}else\"return\"===context.method&&context.abrupt(\"return\",context.arg);state=\"executing\";var record=tryCatch(innerFn,self,context);if(\"normal\"===record.type){if(state=context.done?\"completed\":\"suspendedYield\",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done};}\"throw\"===record.type&&(state=\"completed\",context.method=\"throw\",context.arg=record.arg);}};}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(undefined===method)return context.delegate=null,\"throw\"===methodName&&delegate.iterator.return&&(context.method=\"return\",context.arg=undefined,maybeInvokeDelegate(delegate,context),\"throw\"===context.method)||\"return\"!==methodName&&(context.method=\"throw\",context.arg=new TypeError(\"The iterator does not provide a '\"+methodName+\"' method\")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if(\"throw\"===record.type)return context.method=\"throw\",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,\"return\"!==context.method&&(context.method=\"next\",context.arg=undefined),context.delegate=null,ContinueSentinel):info:(context.method=\"throw\",context.arg=new TypeError(\"iterator result is not an object\"),context.delegate=null,ContinueSentinel);}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry);}function resetTryEntry(entry){var record=entry.completion||{};record.type=\"normal\",delete record.arg,entry.completion=record;}function Context(tryLocsList){this.tryEntries=[{tryLoc:\"root\"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0);}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if(\"function\"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=undefined,next.done=!0,next;};return next.next=next;}}return{next:doneResult};}function doneResult(){return{value:undefined,done:!0};}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,\"constructor\",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,\"constructor\",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,\"GeneratorFunction\"),exports.isGeneratorFunction=function(genFun){var ctor=\"function\"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||\"GeneratorFunction\"===(ctor.displayName||ctor.name));},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,\"GeneratorFunction\")),genFun.prototype=Object.create(Gp),genFun;},exports.awrap=function(arg){return{__await:arg};},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,function(){return this;}),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next();});},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,\"Generator\"),define(Gp,iteratorSymbol,function(){return this;}),define(Gp,\"toString\",function(){return\"[object Generator]\";}),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next;}return next.done=!0,next;};},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method=\"next\",this.arg=undefined,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)\"t\"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=undefined);},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if(\"throw\"===rootRecord.type)throw rootRecord.arg;return this.rval;},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type=\"throw\",record.arg=exception,context.next=loc,caught&&(context.method=\"next\",context.arg=undefined),!!caught;}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if(\"root\"===entry.tryLoc)return handle(\"end\");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,\"catchLoc\"),hasFinally=hasOwn.call(entry,\"finallyLoc\");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);}else{if(!hasFinally)throw new Error(\"try statement without catch or finally\");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,\"finallyLoc\")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break;}}finallyEntry&&(\"break\"===type||\"continue\"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method=\"next\",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record);},complete:function complete(record,afterLoc){if(\"throw\"===record.type)throw record.arg;return\"break\"===record.type||\"continue\"===record.type?this.next=record.arg:\"return\"===record.type?(this.rval=this.arg=record.arg,this.method=\"return\",this.next=\"end\"):\"normal\"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel;},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel;}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(\"throw\"===record.type){var thrown=record.arg;resetTryEntry(entry);}return thrown;}}throw new Error(\"illegal catch attempt\");},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},\"next\"===this.method&&(this.arg=undefined),ContinueSentinel;}},exports;}import React,{useEffect,useReducer}from'react';import*as utils from'../../actions/paper';import{getGroups}from'../../actions/editor';import{Table}from'react-bootstrap';import PaperTableRow from'./PaperTableRow';import'./Paper.css';import ExtractWindow from'./ExtractWindow';function paperReducer(state,action){switch(action.type){case'extractBibtex':{if(state.isExtracting)return state;return _objectSpread(_objectSpread({},state),{},{isExtracting:true,windowMessage:{type:'loading',message:'Extracting...'}});}case'changeProgress':{return _objectSpread(_objectSpread({},state),{},{progress:action.progress});}case'setDatabases':{return _objectSpread(_objectSpread({},state),{},{databases:action.databases});}case'setGroups':{return _objectSpread(_objectSpread({},state),{},{groups:action.groups});}case'selectGroup':{return _objectSpread(_objectSpread({},state),{},{selectedGroup:action.value,selected:'new',windowMessage:{}});}case'selectDatabase':{return _objectSpread(_objectSpread({},state),{},{selected:action.value,inputName:action.value!=='new'?action.value:'',windowMessage:{}});}case'inputName':{return _objectSpread(_objectSpread({},state),{},{inputName:action.value,windowMessage:{}});}case'searchName':{return _objectSpread(_objectSpread({},state),{},{searchName:action.value});}case'uploadFile':{console.log(action.file);if(!action.file||action.file.type!=='application/pdf')return _objectSpread(_objectSpread({},state),{},{uploadedFile:null});return _objectSpread(_objectSpread({},state),{},{uploadedFile:action.file});}case'closeUploaded':{return _objectSpread(_objectSpread({},state),{},{uploadedFile:null});}case'saveFile':{return _objectSpread(_objectSpread({},state),{},{isSaving:true,progress:0});}case'deleteFile':{return _objectSpread(_objectSpread({},state),{},{isDeleting:true,deletedFile:action.file});}case'openWindow':{return _objectSpread(_objectSpread({},state),{},{windowOpened:true,extractedFile:action.file});}case'closeWindow':{if(state.isExtracting)return state;return _objectSpread(_objectSpread({},state),{},{windowOpened:false,windowMessage:{}});}case'finishLoading':{console.log(action.papers);return _objectSpread(_objectSpread({},state),{},{isLoading:false,papers:action.papers,windowMessage:{}});}case'finishDeleting':{if(!action.ok)return _objectSpread(_objectSpread({},state),{},{isDeleting:false});return _objectSpread(_objectSpread({},state),{},{isDeleting:false,isLoading:true});}case'finishSaving':{if(!action.ok)return _objectSpread(_objectSpread({},state),{},{isSaving:false});return _objectSpread(_objectSpread({},state),{},{isSaving:false,isLoading:true,progress:null});}case'finishExtracting':{if(!action.ok)return _objectSpread(_objectSpread({},state),{},{windowMessage:{type:'err',message:action.err},isExtracting:false});return _objectSpread(_objectSpread({},state),{},{isExtracting:false,windowMessage:{type:'success',message:'Reference(s) extracted'}});}case'selectMethod':{return _objectSpread(_objectSpread({},state),{},{selectedMethod:action.value,selectedCitationKey:''});}case'changeCitationKey':{return _objectSpread(_objectSpread({},state),{},{selectedCitationKey:action.value});}default:return state;}}var Paper=function Paper(){var initialState={progress:null,isLoading:true,isDeleting:false,isSaving:false,isExtracting:false,windowOpened:false,papers:null,uploadedFile:null,deletedFile:null,extractedFile:null,groups:null,databases:null,selectedMethod:'header',selectedGroup:'personal',selected:null,inputName:'',searchName:'',windowMessage:{},selectedCitationKey:''};var _useReducer=useReducer(paperReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];useEffect(function(){var setDatabases=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var databases;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return utils.getDatabases();case 2:databases=_context.sent;dispatch({type:'setDatabases',databases:databases});case 4:case\"end\":return _context.stop();}},_callee);}));return function setDatabases(){return _ref.apply(this,arguments);};}();var setGroups=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var groups;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getGroups();case 2:groups=_context2.sent;dispatch({type:'setGroups',groups:groups});case 4:case\"end\":return _context2.stop();}},_callee2);}));return function setGroups(){return _ref2.apply(this,arguments);};}();setGroups();setDatabases();},[]);useEffect(function(){var loadFiles=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var res,papers,promises,_iterator,_step,_loop;return _regeneratorRuntime().wrap(function _callee3$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return utils.getFiles();case 2:res=_context4.sent;papers=res.data.response;promises=[];console.log(papers);_iterator=_createForOfIteratorHelper(papers);_context4.prev=7;_loop=/*#__PURE__*/_regeneratorRuntime().mark(function _loop(){var paper;return _regeneratorRuntime().wrap(function _loop$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:paper=_step.value;promises.push(fetch(\"/api/papers/files/\".concat(paper.file._id)).then(function(res){return res.blob();}).then(function(blob){var url=window.URL.createObjectURL(blob);paper.url=url;}));case 2:case\"end\":return _context3.stop();}},_loop);});_iterator.s();case 10:if((_step=_iterator.n()).done){_context4.next=14;break;}return _context4.delegateYield(_loop(),\"t0\",12);case 12:_context4.next=10;break;case 14:_context4.next=19;break;case 16:_context4.prev=16;_context4.t1=_context4[\"catch\"](7);_iterator.e(_context4.t1);case 19:_context4.prev=19;_iterator.f();return _context4.finish(19);case 22:console.log(papers);_context4.next=25;return Promise.all(promises);case 25:dispatch({type:'finishLoading',papers:papers});case 26:case\"end\":return _context4.stop();}},_callee3,null,[[7,16,19,22]]);}));return function loadFiles(){return _ref3.apply(this,arguments);};}();if(state.isLoading)loadFiles();},[state.isLoading]);useEffect(function(){var deleteFile=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var res;return _regeneratorRuntime().wrap(function _callee4$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.next=2;return utils.deleteFile(state.deletedFile.file._id);case 2:res=_context5.sent;dispatch({type:'finishDeleting',ok:res.data.ok});case 4:case\"end\":return _context5.stop();}},_callee4);}));return function deleteFile(){return _ref4.apply(this,arguments);};}();if(state.isDeleting)deleteFile();},[state.isDeleting,state.deletedFile]);useEffect(function(){var saveFile=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){var res;return _regeneratorRuntime().wrap(function _callee5$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:_context6.next=2;return utils.saveFile(state.uploadedFile,function(n){dispatch({type:'changeProgress',progress:n});});case 2:res=_context6.sent;dispatch({type:'finishSaving',ok:res.data.ok,file:res.data.response});case 4:case\"end\":return _context6.stop();}},_callee5);}));return function saveFile(){return _ref5.apply(this,arguments);};}();if(state.isSaving)saveFile();},[state.isSaving,state.uploadedFile]);useEffect(function(){var extractBibtex=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(){var res,_res;return _regeneratorRuntime().wrap(function _callee6$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:if(state.inputName){_context7.next=2;break;}return _context7.abrupt(\"return\",dispatch({type:'finishExtracting',ok:false,err:'Database name cannot be empty'}));case 2:console.log(state.inputName);if(!(state.selectedMethod==='references')){_context7.next=12;break;}_context7.next=6;return utils.extractAndUploadBibtex(state.extractedFile.file._id,state.inputName,state.selectedGroup==='personal'?null:state.selectedGroup);case 6:res=_context7.sent;console.log(res);console.log(res.data);dispatch({type:'finishExtracting',ok:res.data.ok,err:res.data.err,file:res.data.response});_context7.next=20;break;case 12:if(!(state.selectedCitationKey==='')){_context7.next=14;break;}return _context7.abrupt(\"return\",dispatch({type:'finishExtracting',ok:false,err:'Citation key cannot be empty'}));case 14:_context7.next=16;return utils.extractAndUploadHeader(state.extractedFile.file._id,state.inputName,state.selectedGroup==='personal'?null:state.selectedGroup,state.selectedCitationKey);case 16:_res=_context7.sent;console.log(_res);console.log(_res.data);dispatch({type:'finishExtracting',ok:_res.data.ok,err:_res.data.err,file:_res.data.response});case 20:case\"end\":return _context7.stop();}},_callee6);}));return function extractBibtex(){return _ref6.apply(this,arguments);};}();if(state.isExtracting)extractBibtex();},[state.isExtracting,state.extractedFile,state.selectedCitationKey,state.inputName,state.selectedGroup,state.selectedMethod]);if(state.isLoading||!state.papers){return/*#__PURE__*/React.createElement(\"div\",{className:\"Paper\"},\"Loading\");}var paperFilter=function paperFilter(paper){if(state.searchName===''){return true;}return paper.filename.includes(state.searchName);};var dataTable=state.papers.filter(paperFilter).map(function(paper){return/*#__PURE__*/React.createElement(PaperTableRow,{paper:paper,dispatch:dispatch,key:paper._id});}).reverse();var uploadText=state.uploadedFile?state.uploadedFile.name:'No file selected';return/*#__PURE__*/React.createElement(\"div\",{className:\"Paper\"},/*#__PURE__*/React.createElement(\"div\",{className:state.windowOpened?'paper-layout':'paper-layout disabled',onClick:function onClick(e){return dispatch({type:'closeWindow'});}}),/*#__PURE__*/React.createElement(ExtractWindow,{active:state.windowOpened,file:state.extractedFile,groups:state.groups,citationKey:state.selectedCitationKey,method:state.selectedMethod,selectedGroup:state.selectedGroup,databases:state.databases,inputValue:state.inputName,windowMessage:state.windowMessage,selected:state.selected,dispatch:dispatch}),/*#__PURE__*/React.createElement(\"div\",{className:\"w3-light-grey\"},/*#__PURE__*/React.createElement(\"div\",{className:\"w3-container w3-blue w3-center \".concat(state.progress?'':'disabled'),style:{width:state.progress||0+'%'}},state.progress||0,\"%\")),/*#__PURE__*/React.createElement(\"div\",{className:\"paper-header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"search-label\"},\"Search by file name: \"),/*#__PURE__*/React.createElement(\"input\",{className:\"search-paper\",value:state.searchName,onChange:function onChange(e){return dispatch({type:'searchName',value:e.target.value});}}),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",id:\"paper-file\",className:\"upload-input\",onChange:function onChange(e){return dispatch({type:'uploadFile',file:e.target.files[0]});}}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"paper-file\",className:\"upload-label\"},\"Choose a file\"),/*#__PURE__*/React.createElement(\"button\",{className:\"upload-file-btn \".concat(state.uploadedFile?'':'disabled'),onClick:function onClick(e){return dispatch({type:'saveFile'});}},\"Upload\"),/*#__PURE__*/React.createElement(\"div\",{className:\"upload-file-name \".concat(state.uploadedFile?'activated':'')},uploadText),/*#__PURE__*/React.createElement(\"button\",{className:\"remove-uploaded \".concat(state.uploadedFile?'':'disabled'),onClick:function onClick(e){return dispatch({type:'closeUploaded'});}},\"x\")),/*#__PURE__*/React.createElement(\"div\",{className:\"paper-wrapper\"},/*#__PURE__*/React.createElement(Table,{className:\"paper-table\",striped:true,bordered:true,hover:true},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"Paper\"),/*#__PURE__*/React.createElement(\"th\",null,\"Uploaded\"),/*#__PURE__*/React.createElement(\"th\",null,\"Size\"),/*#__PURE__*/React.createElement(\"th\",null))),/*#__PURE__*/React.createElement(\"tbody\",null,dataTable))));};export default Paper;","map":{"version":3,"names":["React","useEffect","useReducer","utils","getGroups","Table","PaperTableRow","ExtractWindow","paperReducer","state","action","type","isExtracting","windowMessage","message","progress","databases","groups","selectedGroup","value","selected","inputName","searchName","console","log","file","uploadedFile","isSaving","isDeleting","deletedFile","windowOpened","extractedFile","papers","isLoading","ok","err","selectedMethod","selectedCitationKey","Paper","initialState","dispatch","setDatabases","getDatabases","setGroups","loadFiles","getFiles","res","data","response","promises","paper","push","fetch","_id","then","blob","url","window","URL","createObjectURL","Promise","all","deleteFile","saveFile","n","extractBibtex","extractAndUploadBibtex","extractAndUploadHeader","paperFilter","filename","includes","dataTable","filter","map","reverse","uploadText","name","e","width","target","files"],"sources":["/home/spencer/Personal/Bibtex-web-database-master/client/src/components/paper/Paper.js"],"sourcesContent":["import React, { useEffect, useReducer } from 'react';\nimport * as utils from '../../actions/paper';\nimport { getGroups } from '../../actions/editor';\nimport { Table } from 'react-bootstrap';\nimport PaperTableRow from './PaperTableRow';\nimport './Paper.css';\nimport ExtractWindow from './ExtractWindow';\n\nfunction paperReducer(state, action) {\n  switch (action.type) {\n    case 'extractBibtex': {\n      if (state.isExtracting) return state;\n      return {\n        ...state,\n        isExtracting: true,\n        windowMessage: {\n          type: 'loading',\n          message: 'Extracting...',\n        },\n      };\n    }\n    case 'changeProgress': {\n      return {\n        ...state,\n        progress: action.progress,\n      };\n    }\n    case 'setDatabases': {\n      return {\n        ...state,\n        databases: action.databases,\n      };\n    }\n    case 'setGroups': {\n      return {\n        ...state,\n        groups: action.groups,\n      };\n    }\n    case 'selectGroup': {\n      return {\n        ...state,\n        selectedGroup: action.value,\n        selected: 'new',\n        windowMessage: {},\n      };\n    }\n    case 'selectDatabase': {\n      return {\n        ...state,\n        selected: action.value,\n        inputName: action.value !== 'new' ? action.value : '',\n        windowMessage: {},\n      };\n    }\n    case 'inputName': {\n      return {\n        ...state,\n        inputName: action.value,\n        windowMessage: {},\n      };\n    }\n    case 'searchName': {\n      return {\n        ...state,\n        searchName: action.value,\n      };\n    }\n    case 'uploadFile': {\n      console.log(action.file);\n      if (!action.file || action.file.type !== 'application/pdf')\n        return {\n          ...state,\n          uploadedFile: null,\n        };\n      return {\n        ...state,\n        uploadedFile: action.file,\n      };\n    }\n    case 'closeUploaded': {\n      return {\n        ...state,\n        uploadedFile: null,\n      };\n    }\n    case 'saveFile': {\n      return {\n        ...state,\n        isSaving: true,\n        progress: 0,\n      };\n    }\n    case 'deleteFile': {\n      return {\n        ...state,\n        isDeleting: true,\n        deletedFile: action.file,\n      };\n    }\n    case 'openWindow': {\n      return {\n        ...state,\n        windowOpened: true,\n        extractedFile: action.file,\n      };\n    }\n    case 'closeWindow': {\n      if (state.isExtracting) return state;\n      return {\n        ...state,\n        windowOpened: false,\n        windowMessage: {},\n      };\n    }\n    case 'finishLoading': {\n      console.log(action.papers);\n      return {\n        ...state,\n        isLoading: false,\n        papers: action.papers,\n        windowMessage: {},\n      };\n    }\n    case 'finishDeleting': {\n      if (!action.ok) return { ...state, isDeleting: false };\n      return {\n        ...state,\n        isDeleting: false,\n        isLoading: true,\n      };\n    }\n    case 'finishSaving': {\n      if (!action.ok) return { ...state, isSaving: false };\n      return {\n        ...state,\n        isSaving: false,\n        isLoading: true,\n        progress: null,\n      };\n    }\n    case 'finishExtracting': {\n      if (!action.ok)\n        return {\n          ...state,\n          windowMessage: {\n            type: 'err',\n            message: action.err,\n          },\n          isExtracting: false,\n        };\n      return {\n        ...state,\n        isExtracting: false,\n        windowMessage: {\n          type: 'success',\n          message: 'Reference(s) extracted',\n        },\n      };\n    }\n    case 'selectMethod': {\n      return {\n        ...state,\n        selectedMethod: action.value,\n        selectedCitationKey: '',\n      };\n    }\n    case 'changeCitationKey': {\n      return {\n        ...state,\n        selectedCitationKey: action.value,\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n\nconst Paper = () => {\n  const initialState = {\n    progress: null,\n    isLoading: true,\n    isDeleting: false,\n    isSaving: false,\n    isExtracting: false,\n    windowOpened: false,\n    papers: null,\n    uploadedFile: null,\n    deletedFile: null,\n    extractedFile: null,\n    groups: null,\n    databases: null,\n    selectedMethod: 'header',\n    selectedGroup: 'personal',\n    selected: null,\n    inputName: '',\n    searchName: '',\n    windowMessage: {},\n    selectedCitationKey: '',\n  };\n\n  const [state, dispatch] = useReducer(paperReducer, initialState);\n\n  useEffect(() => {\n    const setDatabases = async () => {\n      const databases = await utils.getDatabases();\n      dispatch({\n        type: 'setDatabases',\n        databases,\n      });\n    };\n    const setGroups = async () => {\n      const groups = await getGroups();\n      dispatch({\n        type: 'setGroups',\n        groups,\n      });\n    };\n    setGroups();\n    setDatabases();\n  }, []);\n  useEffect(() => {\n    const loadFiles = async () => {\n      const res = await utils.getFiles();\n      const papers = res.data.response;\n      const promises = [];\n      console.log(papers);\n      for (let paper of papers) {\n        promises.push(\n          fetch(`/api/papers/files/${paper.file._id}`)\n            .then((res) => res.blob())\n            .then((blob) => {\n              const url = window.URL.createObjectURL(blob);\n              paper.url = url;\n            })\n        );\n      }\n      console.log(papers);\n      await Promise.all(promises);\n      dispatch({\n        type: 'finishLoading',\n        papers,\n      });\n    };\n    if (state.isLoading) loadFiles();\n  }, [state.isLoading]);\n  useEffect(() => {\n    const deleteFile = async () => {\n      const res = await utils.deleteFile(state.deletedFile.file._id);\n      dispatch({\n        type: 'finishDeleting',\n        ok: res.data.ok,\n      });\n    };\n    if (state.isDeleting) deleteFile();\n  }, [state.isDeleting, state.deletedFile]);\n  useEffect(() => {\n    const saveFile = async () => {\n      const res = await utils.saveFile(state.uploadedFile, (n) => {\n        dispatch({\n          type: 'changeProgress',\n          progress: n,\n        });\n      });\n      dispatch({\n        type: 'finishSaving',\n        ok: res.data.ok,\n        file: res.data.response,\n      });\n    };\n    if (state.isSaving) saveFile();\n  }, [state.isSaving, state.uploadedFile]);\n  useEffect(() => {\n    const extractBibtex = async () => {\n      if (!state.inputName) {\n        return dispatch({\n          type: 'finishExtracting',\n          ok: false,\n          err: 'Database name cannot be empty',\n        });\n      }\n      console.log(state.inputName);\n      if (state.selectedMethod === 'references') {\n        const res = await utils.extractAndUploadBibtex(\n          state.extractedFile.file._id,\n          state.inputName,\n          state.selectedGroup === 'personal' ? null : state.selectedGroup\n        );\n        console.log(res);\n        console.log(res.data);\n        dispatch({\n          type: 'finishExtracting',\n          ok: res.data.ok,\n          err: res.data.err,\n          file: res.data.response,\n        });\n      } else {\n        if (state.selectedCitationKey === '') {\n          return dispatch({\n            type: 'finishExtracting',\n            ok: false,\n            err: 'Citation key cannot be empty',\n          });\n        }\n        const res = await utils.extractAndUploadHeader(\n          state.extractedFile.file._id,\n          state.inputName,\n          state.selectedGroup === 'personal' ? null : state.selectedGroup,\n          state.selectedCitationKey\n        );\n        console.log(res);\n        console.log(res.data);\n        dispatch({\n          type: 'finishExtracting',\n          ok: res.data.ok,\n          err: res.data.err,\n          file: res.data.response,\n        });\n      }\n    };\n    if (state.isExtracting) extractBibtex();\n  }, [\n    state.isExtracting,\n    state.extractedFile,\n    state.selectedCitationKey,\n    state.inputName,\n    state.selectedGroup,\n    state.selectedMethod,\n  ]);\n\n  if (state.isLoading || !state.papers) {\n    return <div className='Paper'>Loading</div>;\n  }\n\n  const paperFilter = (paper) => {\n    if (state.searchName === '') {\n      return true;\n    }\n    return paper.filename.includes(state.searchName);\n  };\n\n  const dataTable = state.papers\n    .filter(paperFilter)\n    .map((paper) => {\n      return (\n        <PaperTableRow paper={paper} dispatch={dispatch} key={paper._id} />\n      );\n    })\n    .reverse();\n  const uploadText = state.uploadedFile\n    ? state.uploadedFile.name\n    : 'No file selected';\n\n  return (\n    <div className='Paper'>\n      <div\n        className={\n          state.windowOpened ? 'paper-layout' : 'paper-layout disabled'\n        }\n        onClick={(e) => dispatch({ type: 'closeWindow' })}\n      ></div>\n      <ExtractWindow\n        active={state.windowOpened}\n        file={state.extractedFile}\n        groups={state.groups}\n        citationKey={state.selectedCitationKey}\n        method={state.selectedMethod}\n        selectedGroup={state.selectedGroup}\n        databases={state.databases}\n        inputValue={state.inputName}\n        windowMessage={state.windowMessage}\n        selected={state.selected}\n        dispatch={dispatch}\n      />\n      <div className='w3-light-grey'>\n        <div\n          className={`w3-container w3-blue w3-center ${\n            state.progress ? '' : 'disabled'\n          }`}\n          style={{\n            width: state.progress || 0 + '%',\n          }}\n        >\n          {state.progress || 0}%\n        </div>\n      </div>\n      <div className='paper-header'>\n        <div className='search-label'>Search by file name: </div>\n        <input\n          className='search-paper'\n          value={state.searchName}\n          onChange={(e) =>\n            dispatch({\n              type: 'searchName',\n              value: e.target.value,\n            })\n          }\n        ></input>\n        <input\n          type='file'\n          id='paper-file'\n          className='upload-input'\n          onChange={(e) =>\n            dispatch({\n              type: 'uploadFile',\n              file: e.target.files[0],\n            })\n          }\n        ></input>\n        <label htmlFor='paper-file' className='upload-label'>\n          Choose a file\n        </label>\n        <button\n          className={`upload-file-btn ${state.uploadedFile ? '' : 'disabled'}`}\n          onClick={(e) =>\n            dispatch({\n              type: 'saveFile',\n            })\n          }\n        >\n          Upload\n        </button>\n        <div\n          className={`upload-file-name ${\n            state.uploadedFile ? 'activated' : ''\n          }`}\n        >\n          {uploadText}\n        </div>\n        <button\n          className={`remove-uploaded ${state.uploadedFile ? '' : 'disabled'}`}\n          onClick={(e) =>\n            dispatch({\n              type: 'closeUploaded',\n            })\n          }\n        >\n          x\n        </button>\n      </div>\n      <div className='paper-wrapper'>\n        <Table className='paper-table' striped bordered hover>\n          <thead>\n            <tr>\n              <th>Paper</th>\n              <th>Uploaded</th>\n              <th>Size</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>{dataTable}</tbody>\n        </Table>\n      </div>\n    </div>\n  );\n};\n\nexport default Paper;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}