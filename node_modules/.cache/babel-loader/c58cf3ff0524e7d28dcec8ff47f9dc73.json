{"ast":null,"code":"import _slicedToArray from\"/home/spencer/Personal/Bibtex-web-database-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var convertMiddleLine=function convertMiddleLine(key,value){return\"\".concat(key,\" = \\\"\").concat(value,\"\\\",\\n\");};var convertLastLine=function convertLastLine(key,value){return\"\".concat(key,\" = \\\"\").concat(value,\"\\\"}\\n\\n\");};var convertRef=function convertRef(ref){var type=ref.entryType.toLowerCase();var entries=Object.entries(ref.entryTags);var strings=entries.map(function(_ref,i){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];if(i===entries.length-1){return convertLastLine(key,value);}return convertMiddleLine(key,value);});var finalString=\"@\".concat(type,\"{\").concat(ref.citationKey,\",\\n\");strings.forEach(function(str){return finalString+=str;});return finalString;};export var convertRefs=function convertRefs(refs){var finalString='';refs.forEach(function(ref){finalString+=convertRef(ref);});return finalString;};export var xmlToBib=function xmlToBib(xmlText){var _xml$querySelector,_xml$querySelector$qu,_xml$querySelector2,_xml$querySelector2$q;console.log(xmlText);var parser=new DOMParser();var xml=parser.parseFromString(xmlText,'text/xml');var biblStruct=xml.querySelector('biblStruct');if(!biblStruct){return{ok:false};}//\n// Parse Title\n//\nvar title;if(!xml.querySelector('titleStmt')){title=null;}else{title=Array.from(xml.querySelector('titleStmt').querySelectorAll('title')).find(function(titleElem){return titleElem.getAttribute('level')==='a';}).innerHTML;}console.log('TITLE');console.log(title);//\n// Parse authors\n//\nvar authors=Array.from(biblStruct.querySelectorAll('persName')).map(function(elem){var authorString='';Array.from(elem.children).filter(function(elem){return elem.innerHTML!=='•';}).forEach(function(node){authorString+=' '+node.innerHTML;});return authorString.trim();});var author=null;if(authors.length!==0){author=authors.join(', ').trim();}console.log('AUTHOR');console.log(author);//\n// Parse journal\n//\nvar journal=(_xml$querySelector=xml.querySelector('publicationStmt'))===null||_xml$querySelector===void 0?void 0:(_xml$querySelector$qu=_xml$querySelector.querySelector('publisher'))===null||_xml$querySelector$qu===void 0?void 0:_xml$querySelector$qu.innerHTML;console.log('JOURNAL');console.log(journal);//\n// Parse year\n//\nvar year=(_xml$querySelector2=xml.querySelector('publicationStmt'))===null||_xml$querySelector2===void 0?void 0:(_xml$querySelector2$q=_xml$querySelector2.querySelector('date'))===null||_xml$querySelector2$q===void 0?void 0:_xml$querySelector2$q.innerHTML;console.log('YEAR');console.log(year);//\n// Validate\n//\nif(!title||!author||!journal||!year){return{ok:false};}return{ok:true,entry:{title:title,author:author,journal:journal,year:year}};};","map":{"version":3,"names":["convertMiddleLine","key","value","convertLastLine","convertRef","ref","type","entryType","toLowerCase","entries","Object","entryTags","strings","map","i","length","finalString","citationKey","forEach","str","convertRefs","refs","xmlToBib","xmlText","console","log","parser","DOMParser","xml","parseFromString","biblStruct","querySelector","ok","title","Array","from","querySelectorAll","find","titleElem","getAttribute","innerHTML","authors","elem","authorString","children","filter","node","trim","author","join","journal","year","entry"],"sources":["/home/spencer/Personal/Bibtex-web-database-master/client/src/actions/bibtex.js"],"sourcesContent":["const convertMiddleLine = (key, value) => {\n  return `${key} = \"${value}\",\\n`;\n};\n\nconst convertLastLine = (key, value) => {\n  return `${key} = \"${value}\"}\\n\\n`;\n};\n\nconst convertRef = (ref) => {\n  let type = ref.entryType.toLowerCase();\n  const entries = Object.entries(ref.entryTags);\n  const strings = entries.map(([key, value], i) => {\n    if (i === entries.length - 1) {\n      return convertLastLine(key, value);\n    }\n    return convertMiddleLine(key, value);\n  });\n  let finalString = `@${type}{${ref.citationKey},\\n`;\n  strings.forEach((str) => (finalString += str));\n  return finalString;\n};\n\nexport const convertRefs = (refs) => {\n  let finalString = '';\n  refs.forEach((ref) => {\n    finalString += convertRef(ref);\n  });\n  return finalString;\n};\n\nexport const xmlToBib = (xmlText) => {\n  console.log(xmlText);\n  const parser = new DOMParser();\n  const xml = parser.parseFromString(xmlText, 'text/xml');\n  const biblStruct = xml.querySelector('biblStruct');\n  if (!biblStruct) {\n    return { ok: false };\n  }\n  //\n  // Parse Title\n  //\n  let title;\n  if (!xml.querySelector('titleStmt')) {\n    title = null;\n  } else {\n    title = Array.from(\n      xml.querySelector('titleStmt').querySelectorAll('title')\n    ).find((titleElem) => {\n      return titleElem.getAttribute('level') === 'a';\n    }).innerHTML;\n  }\n  console.log('TITLE');\n  console.log(title);\n  //\n  // Parse authors\n  //\n  const authors = Array.from(biblStruct.querySelectorAll('persName')).map(\n    (elem) => {\n      let authorString = '';\n      Array.from(elem.children)\n        .filter((elem) => elem.innerHTML !== '•')\n        .forEach((node) => {\n          authorString += ' ' + node.innerHTML;\n        });\n      return authorString.trim();\n    }\n  );\n  let author = null;\n  if (authors.length !== 0) {\n    author = authors.join(', ').trim();\n  }\n  console.log('AUTHOR');\n  console.log(author);\n  //\n  // Parse journal\n  //\n  const journal = xml\n    .querySelector('publicationStmt')\n    ?.querySelector('publisher')?.innerHTML;\n  console.log('JOURNAL');\n  console.log(journal);\n  //\n  // Parse year\n  //\n  const year = xml.querySelector('publicationStmt')?.querySelector('date')\n    ?.innerHTML;\n  console.log('YEAR');\n  console.log(year);\n  //\n  // Validate\n  //\n  if (!title || !author || !journal || !year) {\n    return { ok: false };\n  }\n  return {\n    ok: true,\n    entry: {\n      title,\n      author,\n      journal,\n      year,\n    },\n  };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}